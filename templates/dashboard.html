{% extends 'base.html' %}
{% block title %}Dashboard | {{ user.get_role_display }}{% endblock %}

{% block content %}
    <header class="mb-5 border-bottom pb-2">
        <h1> Bienvenido, **{{ user.username }}**</h1>
        <p class="lead text-muted">Panel de Control Principal: {{ user.get_role_display }}</p>
    </header>

    {% if user.company %}
        <div class="alert alert-info d-flex align-items-center mb-5">
            <i class="fas fa-industry fa-2x me-3"></i>
            <div>
                Gesti贸n para la Compa帽铆a: <strong>{{ user.company.name }}</strong>. 
                Estado del Plan: 
                {% if user.company.subscription.active %}
                    <span class="badge bg-success fs-6">{{ user.company.subscription.get_plan_name_display }}</span>
                {% else %}
                    <span class="badge bg-danger fs-6">Inactivo</span>
                {% endif %}
                {% if user.role != 'super_admin' %}
                    | **Sucursales:** {{ branch_count }} / {{ user.company.subscription.max_branches|default:0 }}
                {% endif %}
            </div>
        </div>
    {% endif %}

    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        
        {% if user.role == 'super_admin' %}
            
            <div class="col">
                <a href="{% url 'sales:request-list' %}" class="card card-link text-decoration-none shadow-lg h-100 border-primary">
                    <div class="card-body text-center">
                        <i class="fas fa-envelope-open-text fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Solicitudes de Planes</h5>
                        <p class="card-text text-muted">Revisar peticiones de nuevos clientes y dar el alta.</p>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'core:company_list' %}" class="card card-link text-decoration-none shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-building fa-3x text-info mb-3"></i>
                        <h5 class="card-title">Cuentas y Tenancy</h5>
                        <p class="card-text text-muted">Administrar listado de clientes y su estado de actividad.</p>
                    </div>
                </a>
            </div>
            
            <div class="col">
                <a href="{% url 'core:subscription_list' %}" class="card card-link text-decoration-none shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-receipt fa-3x text-success mb-3"></i>
                        <h5 class="card-title">Gesti贸n de Suscripci贸n</h5>
                        <p class="card-text text-muted">Editar planes y l铆mites de servicio.</p>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'accounts:user_create' %}" class="card card-link text-decoration-none shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-users-cog fa-3x text-warning mb-3"></i>
                        <h5 class="card-title">Creaci贸n de Admin Cliente</h5>
                        <p class="card-text text-muted">Configurar credenciales base para nuevos administradores.</p>
                    </div>
                </a>
            </div>

        {% elif user.role == 'admin_cliente' %}
            
            <div class="col">
                <a href="{% url 'sales:pos_sale' %}" class="card card-link text-decoration-none shadow-lg h-100 border-success">
                    <div class="card-body text-center">
                        <i class="fas fa-cash-register fa-3x text-success mb-3"></i>
                        <h5 class="card-title">Punto de Venta (POS)</h5>
                        <p class="card-text lead">**Iniciar Venta R谩pida**</p>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'products:branch_list' %}" class="card card-link text-decoration-none shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-map-marker-alt fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Sucursales y Puntos de Venta</h5>
                        <p class="card-text text-muted">Administrar sucursales y verificar l铆mites de plan.</p>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'products:inventory_list' %}" class="card card-link text-decoration-none shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-warehouse fa-3x text-secondary mb-3"></i>
                        <h5 class="card-title">Inventario y Stock</h5>
                        <p class="card-text text-muted">Gestionar niveles de stock y puntos de reorden.</p>
                    </div>
                </a>
            </div>
            
            <div class="col">
                <a href="{% url 'products:product_list' %}" class="card card-link text-decoration-none shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-boxes fa-3x text-info mb-3"></i>
                        <h5 class="card-title">Gesti贸n de Productos</h5>
                        <p class="card-text text-muted">Creaci贸n y modificaci贸n de cat谩logos.</p>
                    </div>
                </a>
            </div>
            
            <div class="col">
                <a href="{% url 'products:supplier_list' %}" class="card card-link text-decoration-none shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-truck-loading fa-3x text-warning mb-3"></i>
                        <h5 class="card-title">Proveedores</h5>
                        <p class="card-text text-muted">Administrar proveedores y compras.</p>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'accounts:user_create' %}" class="card card-link text-decoration-none shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-user-plus fa-3x text-warning mb-3"></i>
                        <h5 class="card-title">Gesti贸n de Personal</h5>
                        <p class="card-text text-muted">Crear cuentas de Gerentes y Vendedores.</p>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'sales:report-sales' %}" class="card card-link text-decoration-none shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-chart-bar fa-3x text-info mb-3"></i>
                        <h5 class="card-title">Reportes de Ventas</h5>
                        <p class="card-text text-muted">Acceder a los informes de POS y e-commerce.</p>
                    </div>
                </a>
            </div>

        {% elif user.role == 'gerente' %}
            
            <div class="col">
                <a href="{% url 'products:inventory_list' %}" class="card card-link text-decoration-none shadow-lg h-100 border-primary">
                    <div class="card-body text-center">
                        <i class="fas fa-warehouse fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Control de Inventario</h5>
                        <p class="card-text lead">**Verificar stock por sucursal y realizar ajustes.**</p>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'products:product_list' %}" class="card card-link text-decoration-none shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-boxes fa-3x text-secondary mb-3"></i>
                        <h5 class="card-title">Gesti贸n de Productos</h5>
                        <p class="card-text text-muted">Creaci贸n y modificaci贸n de precios y cat谩logos.</p>
                    </div>
                </a>
            </div>
            
            <div class="col">
                <a href="{% url 'products:supplier_list' %}" class="card card-link text-decoration-none shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-truck-loading fa-3x text-warning mb-3"></i>
                        <h5 class="card-title">Proveedores</h5>
                        <p class="card-text text-muted">Ver listado de proveedores y registrar ingresos.</p>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'sales:report-sales' %}" class="card card-link text-decoration-none shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-chart-bar fa-3x text-info mb-3"></i>
                        <h5 class="card-title">Reportes Clave</h5>
                        <p class="card-text text-muted">Ventas por per铆odo y estado de proveedores.</p>
                    </div>
                </a>
            </div>
            
        {% elif user.role == 'vendedor' %}
            <div class="col-md-6 col-lg-4 mx-auto">
                <a href="{% url 'sales:pos_sale' %}" class="card card-link text-decoration-none shadow-lg h-100 border-success">
                    <div class="card-body text-center py-5">
                        <i class="fas fa-cash-register fa-4x text-success mb-3"></i>
                        <h5 class="card-title display-6">Iniciar Punto de Venta</h5>
                        <p class="card-text lead">Comienza a registrar ventas presenciales.</p>
                    </div>
                </a>
            </div>
            
        {% else %}
            <div class="col-md-12">
                <div class="alert alert-secondary text-center">
                    <p class="mb-0">No tienes roles administrativos asignados. Explora nuestro cat谩logo.</p>
                    <a href="{% url 'shop:catalogo' %}" class="btn btn-info mt-2">Ir al Cat谩logo</a>
                </div>
            </div>
        {% endif %}
    </div>

    <style>
        .card-link {
            transition: all 0.2s ease-in-out;
            color: inherit;
        }
        .card-link:hover {
            transform: translateY(-5px);
            border-color: var(--bs-primary) !important;
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
        }
    </style>

{% endblock %}